{"version":3,"file":"DataStore.js","sourceRoot":"","sources":["../src/elements/DataStore.ts"],"names":[],"mappings":"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","sourcesContent":["\nexport interface DataType {\n  games: [\n    {\n      url: string,\n      white: {\n        username: string;\n        rating: number;\n        result: string;\n      };\n      black: {\n        username: string;\n        rating: number;\n        result: string;\n      };\n    }\n  ];\n  players: [\n    {\n      username: string;\n      points: number;\n      is_winner: boolean;\n    }\n  ];\n}\n\nexport interface MatchType {\n  url: string,\n  white: {\n    username: string;\n    rating: number;\n    result: string;\n  };\n  black: {\n    username: string;\n    rating: number;\n    result: string;\n  };\n}\n\nexport interface PlayerType {\n  username: string,\n  points: number,\n  is_winner: boolean\n};\n\n\nexport class DataStore {\n  private static instance: DataStore;\n  private data!: DataType;\n\n  private constructor() { }\n\n  static getInstance(): DataStore {\n    if (!this.instance) {\n      DataStore.instance = new DataStore()\n    }\n    return DataStore.instance\n  }\n\n  async getData(): Promise<DataType> {\n    if (!this.data) {\n      const response = await fetch(\"https://api.chess.com/pub/tournament/late-titled-tuesday-blitz-january-31-2023-3732262/11/1\");\n      if (!response.ok) {\n        throw new Error('Error fetching data from API');\n      } else {\n        this.data = await response.json();\n        this.sortData();\n      }\n    }\n    return this.data\n  }\n\n  private async sortData() {\n    if (!this.data) {\n      await this.getData();\n    }\n    this.data.players.sort((a, b) => {\n      if (a.is_winner === true && b.is_winner === false) return -1;\n      if (b.is_winner === true && a.is_winner === false) return 1;\n      if (a.points > b.points) return -1;\n      if (a.points < b.points) return 1;\n      else return 0;\n    });\n  }\n\n  async getMatchIdFromUsername(username: string) {\n    const match = await this.getMatchFromUsername(username);\n    if (!match) {\n      const matchId = \"None\";\n      return matchId;\n    } else {\n      const matchId = match.url.substring(31);\n      return matchId;\n    }\n    \n  }\n\n  async getMatchFromId(id: string) {\n    if (!this.data) {\n      await this.getData();\n    }\n    const match = this.data.games.filter(game => game.url.includes(id))[0]\n\n    return match;\n  }\n\n  async getMatchFromUsername(username: string) {\n    if (!this.data) {\n      await this.getData();\n    }\n    const match = this.data.games.filter((game) =>\n      game.white.username.toLowerCase() === username.toLowerCase() ||\n      game.black.username.toLowerCase() === username.toLowerCase()\n    )[0]; // why is there an error (I think undefined) when curly brackets surround the filter condition?\n    return match;\n  }\n\n  async getPlayersDetails(playersScoreSearch: number[], usernameSearchString?: string): Promise<PlayerType[]> {\n    if (!this.data) {\n      await this.getData();\n    }\n    // console.log(Array.isArray(playersScoreSearch));\n    // console.log(`playersScoreSearch = ${typeof playersScoreSearch}`)\n    // console.log(typeof []);\n    // console.log(`playersScoreSearch.length = ${playersScoreSearch.length}`);\n    // console.log(`playersScoreSearch = ${playersScoreSearch}`)\n    // console.log(`usernameSearchString = ${usernameSearchString}`);\n    if (usernameSearchString && playersScoreSearch.length === 0) {\n      // console.log('condition 1')\n      const playersData = this.data.players.filter(player => player.username.includes(usernameSearchString));\n      return playersData;\n    } else if (playersScoreSearch.length > 0  && !usernameSearchString) {\n      // console.log('condition 2')\n      const playersData = this.data.players.filter(player => playersScoreSearch.includes(player.points));\n      return playersData;\n    } else if (usernameSearchString && playersScoreSearch.length > 0) {\n      // console.log('condition 3')\n      const playersData = this.data.players.filter(player => player.username.includes(usernameSearchString)\n      && playersScoreSearch.includes(player.points));\n      return playersData;\n    } else {\n      // console.log('condition 4')\n      const playersData = this.data.players;\n      return playersData;\n    }\n  }\n\n  async getPlayerScores() : Promise<Set<number>> {\n    if (!this.data) {\n      await this.getData();\n    }\n    const arrayOfScores: number[] = [];\n    this.data.players.forEach(player => {\n      arrayOfScores.push(player.points)\n    });\n    const setOfScores = new Set(arrayOfScores);\n    return setOfScores;\n  }\n}"]}